<div class="container">
  <ng-container *ngIf="isOwnProfile">
    <h3 class="profileUsername">Welcome, {{user?.username}}!</h3>
  </ng-container>
  <!--if not your profile-->
  <ng-container *ngIf="!isOwnProfile">
    <h3 class="profileUsername">{{user?.username}}'s profile</h3>
  </ng-container>


  <h5 id="profileJoinedDate">Joined: {{user?.formatDate}}</h5>
  <h5 class="profileEmail">Email: {{user?.email}}</h5>
  <h5 id="profileBio">Bio: {{user?.bio == null ? '(No Bio)' : user?.bio}}</h5>

  <h3 *ngIf="isOwnProfile">You are currently logged in. <span *ngIf="posts?.length > 0"><a routerLink="/post/create"> Create a post.</a></span></h3>
</div>

<div class="container">

  <ngb-tabset>
    <ngb-tab title="Posts">
      <ng-template ngbTabContent>

        <div *ngIf="posts?.length == 0">Posts are empty. <a routerLink="/post/create" *ngIf="isOwnProfile"> Create a post.</a></div>
        <div *ngFor="let post of sortedPostsById(posts)" class="margin-top">
          <div class="post-wrapper">
            <a routerLink="/post/{{post.id}}/{{post.title}}">
              <h4 [innerHTML]="post.htmlTitle" id="profile-post-title">{{post.title}}</h4>
            </a>
            <h5 [innerHTML]="post.htmlSubtitle" id="profile-post-subtitle">{{post.subtitle}}</h5>
            <span class="flex post-info-wrapper">
              <span class="margin-right-sm">{{post.hoursMinutes}}</span><span class="margin-right">{{post.formatDate}}</span>

            </span>
            <a routerLink="/post/{{post.id}}/{{post.title}}"><div [innerHTML]="post.htmlLeadImage" id="profile-post-image">{{post.leadImage}}</div></a>
            <div class="flex" style="width:30%;justify-content: space-between;">
              <span class="flex">
                <mat-icon class="post-info-icon margin-left-xsm margin-right-xsm">thumb_up_alt_sharp</mat-icon>{{post.voteCount}}
                <mat-icon class="post-info-icon margin-left margin-right-xsm">remove_red_eye</mat-icon>{{post.voteCount}}
              </span>
              <span>
                <mat-icon [matMenuTriggerFor]="appMenu" *ngIf="isOwnProfile" class="cursor">more_horiz</mat-icon>
                <mat-menu #appMenu="matMenu">
                  <button mat-menu-item [matMenuTriggerFor]="post_remove" class="dropdown-delete-btn"><mat-icon>delete</mat-icon>delete?</button>
                  <button mat-menu-item routerLink="/post/edit/id/{{post.id}}" class="dropdown-edit-btn"><mat-icon>edit</mat-icon>edit</button>
                  <mat-menu #post_remove="matMenu">
                    <button mat-menu-item>
                      <mat-icon (click)="deletePost(post.id)">done</mat-icon>
                      <span>delete</span>
                    </button>
                  </mat-menu>
                </mat-menu>
              </span>
            </div>

          </div>



          <!--<div ngbDropdown class="d-inline-block" *ngIf="isOwnProfile">-->

            <!--<i class="fas fa-ellipsis-h options-ellipsis dropdown-toggle" id="dropdownBasic1" ngbDropdownToggle></i>-->

            <!--<div ngbDropdownMenu aria-labelledby="dropdownBasic1" class="edit-delete-dropdown">-->
              <!--<div>-->
                <!--<a routerLink="/post/edit/id/{{post.id}}" class="dropdown-edit-btn">-->
                  <!--<i class="fas fa-edit"></i> edit-->
                <!--</a>-->
              <!--</div>-->
              <!--<div>-->
                <!--<button (click)="deletePost(post.id)" class="dropdown-delete-btn">-->
                  <!--<i class="fas fa-trash"></i> delete-->
                <!--</button>-->
              <!--</div>-->
            <!--</div>-->
          <!--</div>-->
        </div>

      </ng-template>
    </ngb-tab>
    <ngb-tab title="Comments">
      <!--<ng-template ngbTabTitle><b>Fancy</b> title</ng-template>-->
      <ng-template ngbTabContent>
        <div *ngIf="comments?.length == 0">Posts are empty.>A list of comments the user has made will go here. Seen by everyone.</div>
      </ng-template>
    </ngb-tab>
    <!--<ngb-tab title="Account Settings" [disabled]="true">-->
    <ngb-tab title="Account Settings" *ngIf="isOwnProfile">
      <ng-template ngbTabContent>

        <div class="container margin-top">
            <button class="btn btn-primary margin-bottom" (click)="toggleEditUserForm()">
              Edit Account
            </button>
        <!--<button class="btn" ng-click="toggleEditPasswordForm()"></button>-->
          <ng-container *ngIf="showEditUserForm">
            <app-user-edit></app-user-edit>
          </ng-container>

        </div>

      </ng-template>
    </ngb-tab>
  </ngb-tabset>

</div>
